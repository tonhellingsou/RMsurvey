<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Survey Test – Diagnostic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- jsPsych (from CDN) -->
  <link rel="stylesheet" href="https://unpkg.com/jspsych@7.3.3/css/jspsych.css">
  <script src="https://unpkg.com/jspsych@7.3.3/dist/jspsych.js"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.1.2"></script>
</head>
<body style="background:#fafafa;font-family:sans-serif;margin:2rem">
<script>
/* === DIAGNOSTIC: check if jsPsych actually loaded === */
if (typeof initJsPsych !== "function") {
  document.body.innerHTML = `
    <div style="color:red">
      <h2>❌ jsPsych did NOT load</h2>
      <p>Check the <b>Network</b> tab (F12 → Network) for 404 or blocked files.<br>
      The browser must reach <code>https://unpkg.com/jspsych@7.3.3/dist/jspsych.js</code>.</p>
    </div>`;
  throw new Error("jsPsych not loaded");
}

/* === If we’re here, jsPsych is ready === */
const jsPsych = initJsPsych({
  on_finish: () => {
    const csv = jsPsych.data.get().csv();
    document.body.innerHTML =
      "<h2>✅ jsPsych ran successfully!</h2><pre>" +
      csv.replace(/,/g, "\t") + "</pre>";
  }
});

const timeline = [
  {
    type: jsPsychHtmlButtonResponse,
    stimulus: "<h2>Hello! jsPsych is working.</h2><p>Click to continue.</p>",
    choices: ["OK"]
  },
  {
    type: jsPsychHtmlButtonResponse,
    stimulus: "<p>That’s it — this is a minimal sanity check.</p>",
    choices: ["Finish"]
  }
];

jsPsych.run(timeline);
</script>
</body>
</html>
